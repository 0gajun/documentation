---
title: Security Detection Rules
kind: documentation
further_reading:
- link: "/security_monitoring/explorer"
  tag: "Documentation"
  text: "Search through all of your security signals and perform Security Analytics"
---

## Overview

Use Detection Rules to define conditional logic that is applied to your entire event stream. When at least one case defined in a Detection Rule is matched over a given period of time, Datadog generates a Security Signal.

## Create Detection Rules

To create a Detection Rule in Datadog, use the main navigation: **Security** → **Detection Rules** --> **New Rule**.

### Define the search query

{{< img src="security_monitoring/detection_rules/define_search_query.png" alt="Define the search query" responsive="true">}}

Construct a search query using the same logic as a [log explorer search][1]. Note that each query has a label, which is a lowercase ASCII letter and is not user controllable.

Optionally, define an alert grouping. The defined grouping is used to reduce the number of signals generated. The group-by is also used to join the queries together.

Add additional queries with the **Add Query** button. 


### Define the rule cases

{{< img src="security_monitoring/detection_rules/set_rule_cases.png" alt="Set rule cases" responsive="true">}}

#### Rule case trigger and name

Rule cases, such as `a > 3`, are evaluated as case statements. Thus, the first case to match generates the signal. Click and drag your rule cases to manipulate their ordering.

A rule case contains logical operations (`>, <, >=, <=, &&, ||, !`) to determine if a signal should be generated based on the event counts in the previously defined queries. The ASCII lowercase [query labels](#define-the-search-query) are referenced in this section. 

Provide a **name**, for example "Case 1", for each rule case. This name is appended to the rule name when a signal is generated. 

#### Severity and notification

Set the severity of the Security Signal. The dropdown allows you to select an appropriate severity level (`INFO`, `LOW`, `MEDIUM`, `HIGH`, `CRITICAL`).

The “Notify” section allows you to configure zero or more notification targets for each rule case. 

#### Time windows

A time window is specified to match when at least one of the cases matches true. This is a sliding window and evaluates in real time. 

Once a signal is generated, the signal will remain “open” if a case is matched at least once within this specified time. Each time a new event matches the case, the *last updated* timestamp is updated for the signal. 

A signal will “close” regardless of the query being matched once this time threshold is met. This time is calculated from the time the signal is generated. 

Additional cases can be added by clicking the **Add Case** button. 

### Security Signal Message

{{< img src="security_monitoring/detection_rules/say_whats_happening.png" alt="Say what's happening" responsive="true">}}

The notification box has the same Markdown and **Preview** features as those of [monitor notifications][2]

The **Rule name** section allows you to configure the rule name that appears in the rules list view, as well as the title of the Security Signal when it is generated.

You can tag your signals with different tags, for example `security:anomaly` or `security:threat-intel`.

## Manage Detection Rules

The [Security Configuration Detection Rules][3] page lets you search of all Detection Rules so you can delete or disable the rules. You can also clone or fully edit any individual rule in the search results.

{{< img src="security_monitoring/detection_rules/detection_rules.png" alt="Share Signal" responsive="true" style="width:50%;">}}

### Finding rules

The free text search lets you query Detection Rules by text in the rule name or query. Query results update in real-time as you edit the query—there is no “Search” button to click.  

### Detection Rules Table
The Detection Rules are displayed in the Detection Rules table.

Configure the logs table content according to your needs and preferences with the **Options** button. Only date created and rule ID are available for additional columns.

Detection Rules are sorted alphabetically—ascending by default (A-Z). You can also inverse-sort by name, as well as sort by query name, creation date, or rule ID.

#### Enabling or disabling a rule

You can enable or disable a rule using the toggle switch to the right of the rule.

{{< img src="security_monitoring/detection_rules/enabling.png" alt="Enabling a Rule" responsive="true" style="width:80%;">}}


#### Editing a rule
You can edit a rule by hovering over the rule and clicking the **Edit** button.

{{< img src="security_monitoring/detection_rules/editing.png" alt="Editing a Rule" responsive="true" style="width:80%;">}}


#### Searching for signals generated by a rule
You can search for signals generated by a rule by hovering over the rule and clicking the **View Generated Signals** button.

{{< img src="security_monitoring/detection_rules/searching.png" alt="Searching a Rule" responsive="true" style="width:80%;">}}


#### Cloning a rule
You can clone a rule by hovering over the rule and clicking the **Clone** button.

{{< img src="security_monitoring/detection_rules/cloning.png" alt="Cloning a Rule" responsive="true" style="width:80%;">}}


#### Deleting a rule
You can delete a rule by hovering over the rule and clicking the **Delete** button

{{< img src="security_monitoring/detection_rules/deleting.png" alt="Deleting a Rule" responsive="true" style="width:80%;">}}


## Further Reading 
{{< partial name="whats-next/whats-next.html" >}}



[1]: /logs/explorer/search
[2]: /monitors/notifications
[3]: https://app.datadoghq.com/security/configuration/rules
